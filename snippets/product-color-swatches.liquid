<h3>Color Swatches:</h3>

{% assign option_type = 'color' %}

{% capture colors %}
  {% for product_option in product.options_with_values %}
    {% assign product_option_name = product_option.name | downcase %}
    {% if product_option_name == option_type %}
      {% assign option_index = forloop.index %}
      {% for value in product_option.values %}
        {{- value -}}
        {%- unless forloop.last -%},{%- endunless -%}
      {% endfor %}
    {% endif %}
  {% endfor %}
{% endcapture %}

{% assign all_colors = colors | split: ',' %}

<div class="wrapper">
  <div class="de-u-flex de-u-flexAlignItemsCenter de-u-flexJustifyBetween">
    <div>
      <strong>Color: </strong>
      <span class="de-u-textDarkGray de-u-textMedium js-de-ColorInfo">
        Select a color
      </span>
    </div>
  </div>
</div>

<div class="de-SwatchContainer js-de-ColorSwatches de-Wrapper--fullwidth de-u-padTop06 de-u-padBottom">
  {% for color in all_colors %}
    {% assign option_thumb = false %}
    {% assign clean_color = color | strip %}
    {% for variant in product.variants %}
      {% if option_index == 1 %}{% assign current_color = variant.option1 %}{% endif %}
      {% if option_index == 2 %}{% assign current_color = variant.option2 %}{% endif %}
      {% if option_index == 3 %}{% assign current_color = variant.option3 %}{% endif %}
      {% if current_color == clean_color %}
        {% if variant.image.src %}
          {% assign option_thumb = variant.image.src | img_url %}
        {% endif %}
      {% endif %}
      {% if option_thumb != false %}{% break %}{% endif %}
    {% endfor %}
      <button
        class="de-SwatchColor-item js-de-ColorSwatches-option de-ColorSwatches-color--{{ clean_color }}{% if option_thumb != false %} de-ColorSwatches-hasThumb{% endif %}"
        value="{{ clean_color }}"
        style="{% if option_thumb != false %}background-image:url({{ option_thumb }}){% endif %}"
      ></button>
  {% endfor %}
</div>
