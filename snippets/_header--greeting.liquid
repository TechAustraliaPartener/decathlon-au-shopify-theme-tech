 <!-- Start Sign In/Greeting -->
{% assign maxNameLength = 9 %}
{% assign greetingLength = 6 %}
{% assign emailName = '' %}
{% if customer %}
  {% if customer.first_name != blank %}
    <a href="/account" class="de-MenuBar-action">
      {% include 'patterns-icons-user'
        with class: 'de-MenuBar-icon', role: 'presentation' %}
      <span class="de-MenuBar-label de-u-textNormal de-u-hidden de-u-lg-block">
        Hey,
        {% if customer.first_name.size <= maxNameLength %}
          {{customer.first_name | capitalize }}
        {% else %}
          {{customer.first_name | slice: 0, greetingLength | capitalize }}…
        {% endif %}
      </span>
    </a>
  {% else %}
    <a href="/account" class="de-MenuBar-action">
      {% include 'patterns-icons-user'
        with class: 'de-MenuBar-icon', role: 'presentation' %}
      <span class="de-MenuBar-label de-u-textNormal de-u-hidden de-u-lg-block">
        Hey,
        {% assign emailName = customer.email | split: '@' | first %}
        {% if emailName.size <= maxNameLength %}
          {{ customer.email | split: '@' | first | capitalize }}
        {% else %}
          {{ customer.email | split: '@' | first | slice: 0, greetingLength | capitalize }}…
        {% endif %}
      </span>
    </a>
  {% endif %}
{% else %}
  <a href="/account/login?checkout_url=/" class="de-MenuBar-action">
    {% include 'patterns-icons-user'
      with class: 'de-MenuBar-icon', role: 'presentation' %}
    <span class="de-MenuBar-label de-u-textNormal de-u-hidden de-u-lg-block">
      Sign In
    </span>
  </a>
{% endif %}
<!-- End Sign In/Greeting -->
