{% include 'collection-header-js' %}

{% if collection.image %}
    <div class="collectionImage" style="background-image:url('{{ collection.image | img_url: '1024x' }}'); " data-background-image="{{ collection.image | img_url: '1024x' }}">
        <div class="wrapper">
            {% include 'breadcrumb', adtl_classes: ' breadcrumb--overImage' %}

            <h1 class="collectionImage-header text-center">{{ collection.title }}</h1>
        </div>
    </div>
{% endif %}


<div class="wrapper{% if collection.image %} wrapper--collectionWithBanner u-paddingTopBottom4x{% else %} u-marginBottom4x{% endif %}">
    {% include 'find-top-level-collection' %}
    {% unless collection.image %}
		{% include 'create-breadcrumbs' %}
    {% endunless %}

    <div class="grid">
        <div class="grid__item large--one-quarter left">
            {% include 'nested-navigation' %}
            <!-- Adept Search Start -->
            <div class="adept-collection-filters"></div>
            <!-- Adept Search End -->
        </div>

        <div class="grid__item large--seven-tenths right">
            {% comment %}
            Different markup if a collection description exists
            {% endcomment %}
            {% if current_tags.size %}
                <header class="section-header is-currentTag">
                    <h1 class="section-header__title u-marginBottom0x">{{ tag_title }}</h1>
                </header>
                <hr>
            {% else %}
                {% if collection.description != blank %}
                <header class="section-header">
                    <h1 class="section-header__title">{{ collection.title }}</h1>
                    <div class="rte rte--header">
                        {{ collection.description }}
                    </div>
                </header>
                <hr>
                {% else %}

                <header class="section-header">
                    {%- unless collection.image -%}
                        <h1 class="section-header__title section-header__left">{{ collection.title }}</h1>
                    {%- endunless -%}
                </header>
                <hr>
                {% endif %}
            {% endif %}


            {% assign pageBy = 16 %}
            {% assign offset = 16 %}


            <div id="bc-sf-filter-products" class="grid-uniform adept-collection-products">



                {% paginate collection.products by pageBy %}

                    {% for product in collection.products %}

                        {% assign group_name = 'group' | append: collection.handle %}
                        {% capture featuredClass %}
                            {% cycle group_name: '', ' collectionProduct--featured--middle', ' collectionProduct--featured--end js-adjustFeaturedContent' %}
                        {% endcapture %}
                        {% assign default_giw = 'large--one-third one-half' %}
                        {% if product.tags contains 'featured' %}
                            {% assign grid_item_width = default_giw | append: ' collectionProduct--featured' | append: featuredClass %}
                        {% else %}
                            {% assign grid_item_width = default_giw %}
                        {% endif %}

                        {% include 'product-grid-item' %}

                    {% endfor %}

                    {% if paginate.pages > 1 %}
                        <div class="paginate-bottom">
                            {{ paginate | default_pagination | replace: '&laquo; Previous', '&lang;' | replace: 'Next &raquo;', '&rang;' }}
                        </div>
                    {% endif %}

                {% endpaginate %}

            </div>
        </div>
    </div>
</div>

{% include 'collection-footer-js' %}
